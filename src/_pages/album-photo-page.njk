---
layout: html
pagination:
    data: albums.photoIds
    size: 1
    alias: photoId
permalink: "{{ albums.photos[photoId].slug }}/index.html"
eleventyComputed:
    title: "{{ albums.photos[photoId].description }}"
    description: "{{ albums.photos[photoId].date }} - {{ albums.photos[photoId].albumTitle }}"
    image: "{{ albums.photos[photoId].thumbnailSmall.url | prefixCDN }}"
---
{% set photo = albums.photos[photoId] %}
<main class="flex flex-col max-w-full mx-auto pt-4 pb-4 px-4 sm:px-0 sm:pt-8 h-screen max-h-screen justify-between">
    <nav class="flex flex-col width-control mx-auto justify-center items-baseline mb-8">
        <div class="flex w-full flex-row width-control mx-auto justify-center items-baseline md:flex-row md:justify-between">
            <div class="flex w-full flex-row items-center justify-start my-2 md:justify-start">
                <a class="text-2xl h-full text-left mr-2 md:text-4xl" href="/">
                    <p class="m-0">Zoe Aubert</p>
                </a>
                {% include "themeToggle.njk" %}
            </div>
            <div class="flex w-full justify-end mt-2 md:justify-end">
                <a class="link no-underline" href="javascript:history.back()">Back</a>
            </div>
        </div>
    </nav>
    {# <nav class="flex flex-row width-control mx-auto justify-between items-center mb-4">
        <div class="flex flex- 1 flex-row items-center justify-start my-2">
            <a class="text-4xl h-full text-left" href="/">
                <h1>Zoe Aubert</h1>
            </a>
            {% include "themeToggle.njk" %}
        </div>
        <div class="flex justify-end mt-2">
            <a class="navbarLink" href="javascript:history.back()">Back</a>
        </div>
    </nav> #}
    <div class="flex flex-1 justify-center object-contain overflow-hidden my-4 sm:mx-4">
        {% renderPhoto photo.thumbnailLarge, photo.alt, "flex max-h-full max-w-full" %}
    </div>
    <div class="flex flex-col justify-between items-center sm:mb-8 sm:width-control sm:mx-auto">
        <div class="flex flex-col justify-between items-center">
            <p class="w-full text-center mt-4 mb-2">
                {{photo.description}}
            </p>
            <div class="flex w-full flex-wrap justify-center">
                {% for tag in photo.tags %}
                    <a
                        href="/albums/tags/{{ tag }}/"
                        class="link mr-2 mb-2"
                    >
                        #{{ tag }}
                    </a>
                {% endfor %}
            </div>
        </div>
        <div class="flex w-full justify-between items-center">
            {% if photo.previous %}
                <button
                    type="button"
                    class="flex flex-1 link no-underline h-8 items-center  text-lg"
                    id="previousPhotoButton"
                >
                    ←
                </button>
            {% else %}
                <div class="flex flex-1"></div>
            {% endif %}
            <p class="flex flex-1 justify-center tabular-nums">{{photo.indexString}} / {{ photo.albumTotalPhotos }}</p>
            {% if photo.next %}
                <button
                    type="button"
                    class="flex flex-1 justify-end link no-underline h-8 items-cente text-lg"
                    id="nextPhotoButton"
                >
                    →
                </a>
            {% else %}
                <div class="flex flex-1"></div>
            {% endif %}
        </div>
        <div class="flex w-full justify-between items-center">
            <div class="flex w-full justify-center items-baseline">
                <a
                        href="{{ photo.albumSlug | stripIndex }}"
                        class="text-center link mt-2"
                    >
                        Rest of Album
                    </a>
                <p class="mx-2"> - </p>
                <a
                        class="link"
                        href="{{ photo.url }}"
                        target="_blank"
                        rel="noopener"
                    >
                        Original
                    </a>
            </div>
        </div>
    </div>
</main>
<script type="text/javascript">
    const previousPhotoButton = document.getElementById("previousPhotoButton");
    const nextPhotoButton = document.getElementById("nextPhotoButton");

    function goToPreviousPhoto() {
        window
            .history
            .replaceState(null, '', '{{ albums.photos[photo.previous].slug | d(' ') }}/')
        location.reload()
    }

    function goToNextPhoto() {
        console.log("goToNextPhoto")
        history.replaceState(null, '', '{{ albums.photos[photo.next].slug | d(' ') }}/')
        location.reload()
    }

    function onKeyUp(event) {
        if (event.key === 'Escape') {
            window
                .history
                .back()
        }
        if (event.key === 'ArrowLeft' && previousPhotoButton) {
            goToPreviousPhoto()
        }
        if (event.key === 'ArrowRight' && nextPhotoButton) {
            goToNextPhoto()
        }
    }

    if (previousPhotoButton) {
        previousPhotoButton.addEventListener("click", goToPreviousPhoto);
    }

    if (nextPhotoButton) {
        nextPhotoButton.addEventListener("click", goToNextPhoto);
    }

    window.addEventListener('keyup', onKeyUp)
</script>